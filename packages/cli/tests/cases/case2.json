{
    "target": {
        "provider": "api",
        "repository": {
            "name": "demo"
        }
    },
    "policy": {
        "checks": {
            "bugs": true,
            "performance": true,
            "bestPractices": true
        },
        "modifiedLinesOnly": true,
        "confidence": {
            "enabled": true,
            "minimum": 0.6
        },
        "dedupeAcrossFiles": {
            "enabled": true,
            "threshold": 0.85
        },
        "prompts": {
            "systemPrompt": "Strict JSON only. Do not repeat issues similar to existingComments.",
            "additional": []
        }
    },
    "previousComments": [
        {
            "filePath": "/src/auth.ts",
            "content": "The login function does not verify the password and is vulnerable to SQL injection."
        },
        {
            "filePath": "/src/profile.ts",
            "content": "String concatenation in SQL query allows injection; use parameterized query."
        }
    ],
    "files": [
        {
            "path": "src/auth.ts",
            "changeType": "edit",
            "diff": "diff --git a/src/auth.ts b/src/auth.ts\nindex 111..222 100644\n--- a/src/auth.ts\n+++ b/src/auth.ts\n@@ -1,3 +1,3 @@\n-export function login(user, pass) {\n-  return db.query(\"SELECT * FROM users WHERE u='\" + user + \"' AND p='\" + pass + \"'\");\n-}\n+export function login(user, pass) {\n+  return db.query(\"SELECT * FROM users WHERE u='\" + user + \"'\");\n+}\n"
        },
        {
            "path": "src/profile.ts",
            "changeType": "edit",
            "diff": "diff --git a/src/profile.ts b/src/profile.ts\nindex 111..222 100644\n--- a/src/profile.ts\n+++ b/src/profile.ts\n@@ -10,7 +10,7 @@\n export async function getProfile(id: string) {\n-  const rows = await db.query(\"SELECT * FROM profiles WHERE id = ?\", [id]);\n+  const rows = await db.query(\"SELECT * FROM profiles WHERE id = \" + id);\n   return rows[0];\n }\n"
        }
    ]
}